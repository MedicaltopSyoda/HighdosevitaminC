<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tinder風がん情報アプリ</title>
<style>
  body {
    margin: 0;
    font-family: "Arial", sans-serif;
    background: #f8f8f8;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .view {
    display: none;
    position: absolute;
    width: 100vw;
    height: 100vh;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    text-align: center;
    transition: opacity 0.5s;
  }
  .view.active {
    display: flex;
  }
  .fade-out { opacity: 0; }
  
  /* カードスタイル */
  .card {
    position: absolute;
    width: 80vw;
    max-width: 350px;
    height: 60vh;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    font-weight: bold;
    text-align: center;
    padding: 20px;
    user-select: none;
    transition: transform 0.3s ease, opacity 0.3s ease;
  }
</style>
</head>
<body>

<!-- 1stビュー -->
<div class="view active" id="view1" style="background:#fff; color:#e91e63; font-size:24px;">
  がんの情報のすべてがここにある
</div>

<!-- カードコンテナ -->
<div class="view" id="card-container"></div>

<script>
const cardsData = [
  {text:"あなたはがん患者ですか？\n右スワイプ：はい\n左スワイプ：いいえ", right:"patient", left:"notpatient"},
  {text:"(患者) どちらを知りたいですか？\n右：エビデンス\n左：同じ患者", right:"evidence", left:"peer"},
  {text:"(非患者) あなたは？\n右：家族\n左：それ以外", right:"family", left:"other"},
  {text:"(家族) 何を知りたいですか？\n右：治療法\n左：生存率", right:"treatment", left:"survival"},
  {text:"(その他) あなたは？\n右：研究者\n左：それ以外", right:"researcher", left:"general"}
];

let currentCardIndex = 0;
let container = document.getElementById("card-container");

function createCard(text) {
  const card = document.createElement('div');
  card.className = 'card';
  card.innerText = text;
  container.appendChild(card);

  let startX = 0, currentX = 0;
  let dragging = false;

  card.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
    dragging = true;
  });

  card.addEventListener('touchmove', e => {
    if(!dragging) return;
    currentX = e.touches[0].clientX - startX;
    card.style.transform = `translateX(${currentX}px) rotate(${currentX*0.05}deg)`;
  });

  card.addEventListener('touchend', e => {
    dragging = false;
    if(Math.abs(currentX) > 100){
      let direction = currentX > 0 ? 'right' : 'left';
      card.style.transform = `translateX(${currentX>0?500:-500}px) rotate(${currentX*0.1}deg)`;
      card.style.opacity = 0;
      setTimeout(()=> {
        container.removeChild(card);
        nextCard(direction);
      }, 300);
    }else{
      card.style.transform = `translateX(0)`;
    }
    currentX = 0;
  });
}

// カードを順番に表示
function nextCard(direction){
  console.log("選択:", direction, cardsData[currentCardIndex]?.[direction]);

  currentCardIndex++;
  if(currentCardIndex < cardsData.length){
    createCard(cardsData[currentCardIndex].text);
  } else {
    alert("カードはすべて終了しました");
  }
}

// 1秒後に1stビューをフェードアウト
setTimeout(() => {
  document.getElementById("view1").classList.add("fade-out");
  setTimeout(() => {
    document.getElementById("view1").style.display = "none";
    document.getElementById("card-container").classList.add("active");
    createCard(cardsData[currentCardIndex].text);
  }, 500);
}, 1000);
</script>

</body>
</html>